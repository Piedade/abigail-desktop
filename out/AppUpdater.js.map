{"version":3,"file":"AppUpdater.js","sourceRoot":"","sources":["../src/AppUpdater.ts"],"names":[],"mappings":";AAAA,uCAAgE;AAChE,yBAAyB;AACzB,iCAA6B;AAC7B,uDAA6C;AAG7C;IACE,YAAY,MAAqB;QAC/B,EAAE,CAAC,CAAC,YAAK,EAAE,CAAC,CAAC,CAAC;YACZ,MAAM,CAAA;QACR,CAAC;QAED,MAAM,QAAQ,GAAG,EAAE,CAAC,QAAQ,EAAE,CAAA;QAC9B,EAAE,CAAC,CAAC,QAAQ,KAAK,OAAO,CAAC,CAAC,CAAC;YACzB,MAAM,CAAA;QACR,CAAC;QAED,EAAE,CAAC,CAAC,QAAQ,KAAK,QAAQ,CAAC,CAAC,CAAC;YAC1B,MAAM,GAAG,GAAG,OAAO,CAAC,cAAc,CAAC,CAAA;YACnC,GAAG,CAAC,UAAU,CAAC,IAAI,CAAC,KAAK,GAAG,MAAM,CAAA;YAClC,8BAAW,CAAC,MAAM,GAAG,GAAG,CAAA;QAC1B,CAAC;QAED,8BAAW,CAAC,OAAO,CAAC,gBAAgB,CAAC,EAAE;YACrC,MAAM,CAAC,kCAAkC,EAAE,WAAW,EAAE,CAAC,OAAO,4DAA4D,CAAC,CAAA;QAC/H,CAAC,CAAC,CAAA;QACF,8BAAW,CAAC,eAAe,EAAE,CAAA;IAC/B,CAAC;CACF;;AAtBD,6BAsBC;AAED,gBAAgB,KAAa,EAAE,OAAe;IAC5C,IAAI,OAAO,GAAG,wBAAqB,CAAC,aAAa,EAAE,CAAA;IACnD,EAAE,CAAC,CAAC,OAAO,CAAC,MAAM,IAAI,CAAC,CAAC,CAAC,CAAC;QACxB,MAAM,CAAA;IACR,CAAC;IAED,OAAO,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC,IAAI,CAAC,QAAQ,EAAE,KAAK,EAAE,OAAO,CAAC,CAAA;AACvD,CAAC","sourcesContent":["import {BrowserWindow as BrowserWindowElectron} from \"electron\";\nimport * as os from \"os\";\nimport {isDev} from \"./util\";\nimport {autoUpdater} from \"electron-updater\";\nimport BrowserWindow = Electron.BrowserWindow\n\nexport default class AppUpdater {\n  constructor(window: BrowserWindow) {\n    if (isDev()) {\n      return\n    }\n\n    const platform = os.platform()\n    if (platform === \"linux\") {\n      return\n    }\n\n    if (platform === \"darwin\") {\n      const log = require(\"electron-log\")\n      log.transports.file.level = \"info\"\n      autoUpdater.logger = log\n    }\n\n    autoUpdater.signals.updateDownloaded(it => {\n      notify(\"A new update is ready to install\", `Version ${it.version} is downloaded and will be automatically installed on Quit`)\n    })\n    autoUpdater.checkForUpdates()\n  }\n}\n\nfunction notify(title: string, message: string) {\n  let windows = BrowserWindowElectron.getAllWindows()\n  if (windows.length == 0) {\n    return\n  }\n\n  windows[0].webContents.send(\"notify\", title, message)\n}"]}